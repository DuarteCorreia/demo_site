!function(e){"use strict";e.fn.lightbox=function(t){var i={margin:50,nav:!0,blur:!0,minSize:0},a={items:[],lightbox:null,image:null,current:null,locked:!1,caption:null,init:function(t){a.items=t,a.selector="lightbox-"+Math.random().toString().replace(".",""),a.lightbox||(e("body").append('<div id="lightbox" style="display:none;"><a href="#" class="lightbox-close lightbox-button"></a><div class="lightbox-nav"><a href="#" class="lightbox-previous lightbox-button"></a><a href="#" class="lightbox-next lightbox-button"></a></div><div href="#" class="lightbox-caption"><p></p></div></div>'),a.lightbox=e("#lightbox"),a.caption=e(".lightbox-caption",a.lightbox)),a.items.length>1&&i.nav?e(".lightbox-nav",a.lightbox).show():e(".lightbox-nav",a.lightbox).hide(),a.bindEvents()},loadImage:function(){i.blur&&e("body").addClass("blurred"),e("img",a.lightbox).remove(),a.lightbox.fadeIn("fast").append('<span class="lightbox-loading"></span>');var t=e('<img src="'+e(a.current).attr("href")+'" draggable="false">');e(t).load(function(){e(".lightbox-loading").remove(),a.lightbox.append(t),a.image=e("img",a.lightbox).hide(),a.resizeImage(),a.setCaption()})},setCaption:function(){var t=e(a.current).data("caption");t&&t.length>0?(a.caption.fadeIn(),e("p",a.caption).text(t)):a.caption.hide()},resizeImage:function(){var t,n,o,s,r;n=e(window).height()-i.margin,o=e(window).outerWidth(!0)-i.margin,a.image.width("").height(""),s=a.image.height(),r=a.image.width(),r>o&&(t=o/r,r=o,s=Math.round(s*t)),s>n&&(t=n/s,s=n,r=Math.round(r*t)),a.image.width(r).height(s).css({top:(e(window).height()-a.image.outerHeight())/2+"px",left:(e(window).width()-a.image.outerWidth())/2+"px"}).show(),a.locked=!1},getCurrentIndex:function(){return e.inArray(a.current,a.items)},next:function(){return a.locked?!1:(a.locked=!0,a.getCurrentIndex()>=a.items.length-1?e(a.items[0]).click():e(a.items[a.getCurrentIndex()+1]).click(),void 0)},previous:function(){return a.locked?!1:(a.locked=!0,a.getCurrentIndex()<=0?e(a.items[a.items.length-1]).click():e(a.items[a.getCurrentIndex()-1]).click(),void 0)},bindEvents:function(){e(a.items).click(function(t){if(!e("#lightbox").is(":visible")&&(e(window).width()<i.minSize||e(window).height()<i.minSize))return e(this).attr("target","_blank"),void 0;var n=e(this)[0];t.preventDefault(),a.current=n,a.loadImage(),e(document).on("keydown",function(e){27===e.keyCode&&a.close(),39===e.keyCode&&a.next(),37===e.keyCode&&a.previous()})}),a.lightbox.on("click",function(e){this===e.target&&a.close()}),e(a.lightbox).on("click",".lightbox-previous",function(){return a.previous(),!1}),e(a.lightbox).on("click",".lightbox-next",function(){return a.next(),!1}),e(a.lightbox).on("click",".lightbox-close",function(){return a.close(),!1}),e(window).resize(function(){a.image&&a.resizeImage()})},close:function(){e(document).off("keydown"),e(a.lightbox).fadeOut("fast"),e("body").removeClass("blurred")}};e.extend(i,t),a.init(this)}}(jQuery);