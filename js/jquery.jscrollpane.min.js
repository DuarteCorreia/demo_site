(function(e,t,n){e.fn.jScrollPane=function(r){function i(r,i){function V(t){var i,o,g,y,w,E,x=false,T=false;s=t;if(u===n){w=r.scrollTop();E=r.scrollLeft();r.css({overflow:"hidden",padding:0});a=r.innerWidth()+F;f=r.innerHeight();r.width(a);u=e('<div class="jspPane" />').css("padding",j).append(r.children());l=e('<div class="jspContainer" />').css({width:a+"px",height:f+"px"}).append(u).appendTo(r)}else{r.css("width","");x=s.stickToBottom&&mt();T=s.stickToRight&&gt();y=r.innerWidth()+F!=a||r.outerHeight()!=f;if(y){a=r.innerWidth()+F;f=r.innerHeight();l.css({width:a+"px",height:f+"px"})}if(!y&&I==c&&u.outerHeight()==h){r.width(a);return}I=c;u.css("width","");r.width(a);l.find(">.jspVerticalBar,>.jspHorizontalBar").remove().end()}u.css("overflow","auto");if(t.contentWidth){c=t.contentWidth}else{c=u[0].scrollWidth}h=u[0].scrollHeight;u.css("overflow","");p=c/a;d=h/f;v=d>1;m=p>1;if(!(m||v)){r.removeClass("jspScrollable");u.css({top:0,left:0,width:l.width()-F});bt();St();Tt();rt()}else{r.addClass("jspScrollable");i=s.maintainPosition&&(b||S);if(i){o=dt();g=vt()}J();Q();Y();if(i){ht(T?c-a:o,false);ct(x?h-f:g,false)}Et();yt();kt();if(s.enableKeyboardNavigation){xt()}if(s.clickOnTrack){nt()}Nt();if(s.hijackInternalLinks){Ct()}}if(s.autoReinitialise&&!B){B=setInterval(function(){V(s)},s.autoReinitialiseDelay)}else if(!s.autoReinitialise&&B){clearInterval(B)}w&&r.scrollTop(0)&&ct(w,false);E&&r.scrollLeft(0)&&ht(E,false);r.trigger("jsp-initialised",[m||v])}function J(){if(v){l.append(e('<div class="jspVerticalBar" />').append(e('<div class="jspCap jspCapTop" />'),e('<div class="jspTrack" />').append(e('<div class="jspDrag" />').append(e('<div class="jspDragTop" />'),e('<div class="jspDragBottom" />'))),e('<div class="jspCap jspCapBottom" />')));x=l.find(">.jspVerticalBar");T=x.find(">.jspTrack");g=T.find(">.jspDrag");if(s.showArrows){L=e('<a class="jspArrow jspArrowUp" />').bind("mousedown.jsp",et(0,-1)).bind("click.jsp",wt);A=e('<a class="jspArrow jspArrowDown" />').bind("mousedown.jsp",et(0,1)).bind("click.jsp",wt);if(s.arrowScrollOnHover){L.bind("mouseover.jsp",et(0,-1,L));A.bind("mouseover.jsp",et(0,1,A))}Z(T,s.verticalArrowPositions,L,A)}C=f;l.find(">.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow").each(function(){C-=e(this).outerHeight()});g.hover(function(){g.addClass("jspHover")},function(){g.removeClass("jspHover")}).bind("mousedown.jsp",function(t){e("html").bind("dragstart.jsp selectstart.jsp",wt);g.addClass("jspActive");var n=t.pageY-g.position().top;e("html").bind("mousemove.jsp",function(e){st(e.pageY-n,false)}).bind("mouseup.jsp mouseleave.jsp",it);return false});K()}}function K(){T.height(C+"px");b=0;N=s.verticalGutter+T.outerWidth();u.width(a-N-F);try{if(x.position().left===0){u.css("margin-left",N+"px")}}catch(e){}}function Q(){if(m){l.append(e('<div class="jspHorizontalBar" />').append(e('<div class="jspCap jspCapLeft" />'),e('<div class="jspTrack" />').append(e('<div class="jspDrag" />').append(e('<div class="jspDragLeft" />'),e('<div class="jspDragRight" />'))),e('<div class="jspCap jspCapRight" />')));O=l.find(">.jspHorizontalBar");M=O.find(">.jspTrack");w=M.find(">.jspDrag");if(s.showArrows){P=e('<a class="jspArrow jspArrowLeft" />').bind("mousedown.jsp",et(-1,0)).bind("click.jsp",wt);H=e('<a class="jspArrow jspArrowRight" />').bind("mousedown.jsp",et(1,0)).bind("click.jsp",wt);if(s.arrowScrollOnHover){P.bind("mouseover.jsp",et(-1,0,P));H.bind("mouseover.jsp",et(1,0,H))}Z(M,s.horizontalArrowPositions,P,H)}w.hover(function(){w.addClass("jspHover")},function(){w.removeClass("jspHover")}).bind("mousedown.jsp",function(t){e("html").bind("dragstart.jsp selectstart.jsp",wt);w.addClass("jspActive");var n=t.pageX-w.position().left;e("html").bind("mousemove.jsp",function(e){ut(e.pageX-n,false)}).bind("mouseup.jsp mouseleave.jsp",it);return false});_=l.innerWidth();G()}}function G(){l.find(">.jspHorizontalBar>.jspCap:visible,>.jspHorizontalBar>.jspArrow").each(function(){_-=e(this).outerWidth()});M.width(_+"px");S=0}function Y(){if(m&&v){var t=M.outerHeight(),n=T.outerWidth();C-=t;e(O).find(">.jspCap:visible,>.jspArrow").each(function(){_+=e(this).outerWidth()});_-=n;f-=n;a-=t;M.parent().append(e('<div class="jspCorner" />').css("width",t+"px"));K();G()}if(m){u.width(l.outerWidth()-F+"px")}h=u.outerHeight();d=h/f;if(m){D=Math.ceil(1/p*_);if(D>s.horizontalDragMaxWidth){D=s.horizontalDragMaxWidth}else if(D<s.horizontalDragMinWidth){D=s.horizontalDragMinWidth}w.width(D+"px");E=_-D;at(S)}if(v){k=Math.ceil(1/d*C);if(k>s.verticalDragMaxHeight){k=s.verticalDragMaxHeight}else if(k<s.verticalDragMinHeight){k=s.verticalDragMinHeight}g.height(k+"px");y=C-k;ot(b)}}function Z(e,t,n,r){var i="before",s="after",o;if(t=="os"){t=/Mac/.test(navigator.platform)?"after":"split"}if(t==i){s=t}else if(t==s){i=t;o=n;n=r;r=o}e[i](n)[s](r)}function et(e,t,n){return function(){tt(e,t,this,n);this.blur();return false}}function tt(t,n,r,i){r=e(r).addClass("jspActive");var u,a,f=true,l=function(){if(t!==0){o.scrollByX(t*s.arrowButtonSpeed)}if(n!==0){o.scrollByY(n*s.arrowButtonSpeed)}a=setTimeout(l,f?s.initialDelay:s.arrowRepeatFreq);f=false};l();u=i?"mouseout.jsp":"mouseup.jsp";i=i||e("html");i.bind(u,function(){r.removeClass("jspActive");a&&clearTimeout(a);a=null;i.unbind(u)})}function nt(){rt();if(v){T.bind("mousedown.jsp",function(t){if(t.originalTarget===n||t.originalTarget==t.currentTarget){var r=e(this),i=r.offset(),u=t.pageY-i.top-b,a,l=true,c=function(){var e=r.offset(),n=t.pageY-e.top-k/2,i=f*s.scrollPagePercent,d=y*i/(h-f);if(u<0){if(b-d>n){o.scrollByY(-i)}else{st(n)}}else if(u>0){if(b+d<n){o.scrollByY(i)}else{st(n)}}else{p();return}a=setTimeout(c,l?s.initialDelay:s.trackClickRepeatFreq);l=false},p=function(){a&&clearTimeout(a);a=null;e(document).unbind("mouseup.jsp",p)};c();e(document).bind("mouseup.jsp",p);return false}})}if(m){M.bind("mousedown.jsp",function(t){if(t.originalTarget===n||t.originalTarget==t.currentTarget){var r=e(this),i=r.offset(),u=t.pageX-i.left-S,f,l=true,h=function(){var e=r.offset(),n=t.pageX-e.left-D/2,i=a*s.scrollPagePercent,d=E*i/(c-a);if(u<0){if(S-d>n){o.scrollByX(-i)}else{ut(n)}}else if(u>0){if(S+d<n){o.scrollByX(i)}else{ut(n)}}else{p();return}f=setTimeout(h,l?s.initialDelay:s.trackClickRepeatFreq);l=false},p=function(){f&&clearTimeout(f);f=null;e(document).unbind("mouseup.jsp",p)};h();e(document).bind("mouseup.jsp",p);return false}})}}function rt(){if(M){M.unbind("mousedown.jsp")}if(T){T.unbind("mousedown.jsp")}}function it(){e("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp");if(g){g.removeClass("jspActive")}if(w){w.removeClass("jspActive")}}function st(e,t){if(!v){return}if(e<0){e=0}else if(e>y){e=y}if(t===n){t=s.animateScroll}if(t){o.animate(g,"top",e,ot)}else{g.css("top",e);ot(e)}}function ot(e){if(e===n){e=g.position().top}l.scrollTop(0);b=e;var t=b===0,i=b==y,s=e/y,o=-s*(h-f);if(q!=t||U!=i){q=t;U=i;r.trigger("jsp-arrow-change",[q,U,R,z])}ft(t,i);u.css("top",o);r.trigger("jsp-scroll-y",[-o,t,i]).trigger("scroll")}function ut(e,t){if(!m){return}if(e<0){e=0}else if(e>E){e=E}if(t===n){t=s.animateScroll}if(t){o.animate(w,"left",e,at)}else{w.css("left",e);at(e)}}function at(e){if(e===n){e=w.position().left}l.scrollTop(0);S=e;var t=S===0,i=S==E,s=e/E,o=-s*(c-a);if(R!=t||z!=i){R=t;z=i;r.trigger("jsp-arrow-change",[q,U,R,z])}lt(t,i);u.css("left",o);r.trigger("jsp-scroll-x",[-o,t,i]).trigger("scroll")}function ft(e,t){if(s.showArrows){L[e?"addClass":"removeClass"]("jspDisabled");A[t?"addClass":"removeClass"]("jspDisabled")}}function lt(e,t){if(s.showArrows){P[e?"addClass":"removeClass"]("jspDisabled");H[t?"addClass":"removeClass"]("jspDisabled")}}function ct(e,t){var n=e/(h-f);st(n*y,t)}function ht(e,t){var n=e/(c-a);ut(n*E,t)}function pt(t,n,r){var i,o,u,c=0,h=0,p,d,v,m,g,y;try{i=e(t)}catch(b){return}o=i.outerHeight();u=i.outerWidth();l.scrollTop(0);l.scrollLeft(0);while(!i.is(".jspPane")){c+=i.position().top;h+=i.position().left;i=i.offsetParent();if(/^body|html$/i.test(i[0].nodeName)){return}}p=vt();v=p+f;if(c<p||n){g=c-s.verticalGutter}else if(c+o>v){g=c-f+o+s.verticalGutter}if(!isNaN(g)){ct(g,r)}d=dt();m=d+a;if(h<d||n){y=h-s.horizontalGutter}else if(h+u>m){y=h-a+u+s.horizontalGutter}if(!isNaN(y)){ht(y,r)}}function dt(){return-u.position().left}function vt(){return-u.position().top}function mt(){var e=h-f;return e>20&&e-vt()<10}function gt(){var e=c-a;return e>20&&e-dt()<10}function yt(){l.unbind(X).bind(X,function(e,t,n,r){var i=S,u=b;o.scrollBy(n*s.mouseWheelSpeed,-r*s.mouseWheelSpeed,false);return i==S&&u==b})}function bt(){l.unbind(X)}function wt(){return false}function Et(){u.find(":input,a").unbind("focus.jsp").bind("focus.jsp",function(e){pt(e.target,false)})}function St(){u.find(":input,a").unbind("focus.jsp")}function xt(){function a(){var e=S,r=b;switch(t){case 40:o.scrollByY(s.keyboardSpeed,false);break;case 38:o.scrollByY(-s.keyboardSpeed,false);break;case 34:case 32:o.scrollByY(f*s.scrollPagePercent,false);break;case 33:o.scrollByY(-f*s.scrollPagePercent,false);break;case 39:o.scrollByX(s.keyboardSpeed,false);break;case 37:o.scrollByX(-s.keyboardSpeed,false);break}n=e!=S||r!=b;return n}var t,n,i=[];m&&i.push(O[0]);v&&i.push(x[0]);u.focus(function(){r.focus()});r.attr("tabindex",0).unbind("keydown.jsp keypress.jsp").bind("keydown.jsp",function(r){if(r.target!==this&&!(i.length&&e(r.target).closest(i).length)){return}var s=S,o=b;switch(r.keyCode){case 40:case 38:case 34:case 32:case 33:case 39:case 37:t=r.keyCode;a();break;case 35:ct(h-f);t=null;break;case 36:ct(0);t=null;break}n=r.keyCode==t&&s!=S||o!=b;return!n}).bind("keypress.jsp",function(e){if(e.keyCode==t){a()}return!n});if(s.hideFocus){r.css("outline","none");if("hideFocus"in l[0]){r.attr("hideFocus",true)}}else{r.css("outline","");if("hideFocus"in l[0]){r.attr("hideFocus",false)}}}function Tt(){r.attr("tabindex","-1").removeAttr("tabindex").unbind("keydown.jsp keypress.jsp")}function Nt(){if(location.hash&&location.hash.length>1){var t,n,r=escape(location.hash.substr(1));try{t=e("#"+r+', a[name="'+r+'"]')}catch(i){return}if(t.length&&u.find(r)){if(l.scrollTop()===0){n=setInterval(function(){if(l.scrollTop()>0){pt(t,true);e(document).scrollTop(l.position().top);clearInterval(n)}},50)}else{pt(t,true);e(document).scrollTop(l.position().top)}}}}function Ct(){if(e(document.body).data("jspHijack")){return}e(document.body).data("jspHijack",true);e(document.body).delegate("a[href*=#]","click",function(n){var r=this.href.substr(0,this.href.indexOf("#")),i=location.href,s,o,u,a,f,l;if(location.href.indexOf("#")!==-1){i=location.href.substr(0,location.href.indexOf("#"))}if(r!==i){return}s=escape(this.href.substr(this.href.indexOf("#")+1));o;try{o=e("#"+s+', a[name="'+s+'"]')}catch(c){return}if(!o.length){return}u=o.closest(".jspScrollable");a=u.data("jsp");a.scrollToElement(o,true);if(u[0].scrollIntoView){f=e(t).scrollTop();l=o.offset().top;if(l<f||l>f+e(t).height()){u[0].scrollIntoView()}}n.preventDefault()})}function kt(){var e,t,n,r,i,s=false;l.unbind("touchstart.jsp touchmove.jsp touchend.jsp click.jsp-touchclick").bind("touchstart.jsp",function(o){var u=o.originalEvent.touches[0];e=dt();t=vt();n=u.pageX;r=u.pageY;i=false;s=true}).bind("touchmove.jsp",function(u){if(!s){return}var a=u.originalEvent.touches[0],f=S,l=b;o.scrollTo(e+n-a.pageX,t+r-a.pageY);i=i||Math.abs(n-a.pageX)>5||Math.abs(r-a.pageY)>5;return f==S&&l==b}).bind("touchend.jsp",function(e){s=false}).bind("click.jsp-touchclick",function(e){if(i){i=false;return false}})}function Lt(){var e=vt(),t=dt();r.removeClass("jspScrollable").unbind(".jsp");r.replaceWith(W.append(u.children()));W.scrollTop(e);W.scrollLeft(t);if(B){clearInterval(B)}}var s,o=this,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q=true,R=true,U=false,z=false,W=r.clone(false,false).empty(),X=e.fn.mwheelIntent?"mwheelIntent.jsp":"mousewheel.jsp";if(r.css("box-sizing")==="border-box"){j=0;F=0}else{j=r.css("paddingTop")+" "+r.css("paddingRight")+" "+r.css("paddingBottom")+" "+r.css("paddingLeft");F=(parseInt(r.css("paddingLeft"),10)||0)+(parseInt(r.css("paddingRight"),10)||0)}e.extend(o,{reinitialise:function(t){t=e.extend({},s,t);V(t)},scrollToElement:function(e,t,n){pt(e,t,n)},scrollTo:function(e,t,n){ht(e,n);ct(t,n)},scrollToX:function(e,t){ht(e,t)},scrollToY:function(e,t){ct(e,t)},scrollToPercentX:function(e,t){ht(e*(c-a),t)},scrollToPercentY:function(e,t){ct(e*(h-f),t)},scrollBy:function(e,t,n){o.scrollByX(e,n);o.scrollByY(t,n)},scrollByX:function(e,t){var n=dt()+Math[e<0?"floor":"ceil"](e),r=n/(c-a);ut(r*E,t)},scrollByY:function(e,t){var n=vt()+Math[e<0?"floor":"ceil"](e),r=n/(h-f);st(r*y,t)},positionDragX:function(e,t){ut(e,t)},positionDragY:function(e,t){st(e,t)},animate:function(e,t,n,r){var i={};i[t]=n;e.animate(i,{duration:s.animateDuration,easing:s.animateEase,queue:false,step:r})},getContentPositionX:function(){return dt()},getContentPositionY:function(){return vt()},getContentWidth:function(){return c},getContentHeight:function(){return h},getPercentScrolledX:function(){return dt()/(c-a)},getPercentScrolledY:function(){return vt()/(h-f)},getIsScrollableH:function(){return m},getIsScrollableV:function(){return v},getContentPane:function(){return u},scrollToBottom:function(e){st(y,e)},hijackInternalLinks:e.noop,destroy:function(){Lt()}});V(i)}r=e.extend({},e.fn.jScrollPane.defaults,r);e.each(["arrowButtonSpeed","trackClickSpeed","keyboardSpeed"],function(){r[this]=r[this]||r.speed});return this.each(function(){var t=e(this),n=t.data("jsp");if(n){n.reinitialise(r)}else{e("script",t).filter('[type="text/javascript"],:not([type])').remove();n=new i(t,r);t.data("jsp",n)}})};e.fn.jScrollPane.defaults={showArrows:false,maintainPosition:true,stickToBottom:false,stickToRight:false,clickOnTrack:true,autoReinitialise:false,autoReinitialiseDelay:500,verticalDragMinHeight:0,verticalDragMaxHeight:99999,horizontalDragMinWidth:0,horizontalDragMaxWidth:99999,contentWidth:n,animateScroll:false,animateDuration:300,animateEase:"linear",hijackInternalLinks:false,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:3,arrowButtonSpeed:0,arrowRepeatFreq:50,arrowScrollOnHover:false,trackClickSpeed:0,trackClickRepeatFreq:70,verticalArrowPositions:"split",horizontalArrowPositions:"split",enableKeyboardNavigation:true,hideFocus:false,keyboardSpeed:0,initialDelay:300,speed:30,scrollPagePercent:.8}})(jQuery,this)